% this example was copied from the original Dedalus paper

sbcast(#Member, Sender, Message)@async <-
  smessage(#Agent, Sender, Message),
  members(#Agent, Member);

sdeliver(Member, Sender, Message) <-
  sbcast(Member, Sender, Message);



smessage(Agent, Sender, Message) <-
  rmessage(Agent, Sender, Message);

buf_bcast(Sender, Me, Message) <-
  sdeliver(Me, Sender, Message);

smessage(Me, Sender, Message) <-
  buf_bcast(Sender, Me, Message);

rdeliver(Me, Sender, Message)@next <-
  buf_bcast(Sender, Me, Message);

% It seems like there is an error. Locations variables are not referenced properly,
% like #Sender. For now I gonna leave as is.
% TODO: check if broadcast code is correct 

test_passed;